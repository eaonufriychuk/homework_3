!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="static",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.basket=void 0,n(4);var o=i(n(3)),r=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}new o.default;t.basket=new r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.goods=JSON.parse(localStorage.getItem("cart"))||[],this.state={count:0},this.render(),this.renderGoods()}return r(e,[{key:"render",value:function(){var e=document.getElementById("basket"),t=document.createElement("div"),n=document.createElement("div"),o=document.createElement("h4"),r=document.createElement("div"),i=document.createElement("div"),a=document.createElement("p");t.classList.add("card"),n.classList.add("card-header"),r.classList.add("card-body"),i.classList.add("basket-items"),a.classList.add("basket-content"),o.textContent="Cart",e.appendChild(t),t.appendChild(n),n.appendChild(o),t.appendChild(r),r.appendChild(a),r.appendChild(i),a.textContent="Количество товаров: "+this.goods.length}},{key:"renderGoods",value:function(){var e=this;if(0!==this.goods.length){this.reset();var t=document.querySelector(".basket-items");this.goods.forEach(function(n){var o=document.createElement("div"),r=document.createElement("div");o.classList.add("item"),r.classList.add("close"),r.setAttribute("data-id",""+(n.id+1)),o.textContent=""+(n.id+1),r.textContent="x",o.appendChild(r),t.appendChild(o),e.addEventListener(r)})}}},{key:"reset",value:function(){var e=document.querySelector(".basket-items"),t=document.querySelector(".basket-content");e.innerHTML="",t.textContent="Количество товаров: "+this.goods.length}},{key:"addGood",value:function(e){"object"===(void 0===e?"undefined":o(e))&&(this.goods.some(function(t){return t.id===e.id})||(this.goods.push(e),this.basketStorage(e.id,"POST"),this.state.count++,this.reset(),this.renderGoods()))}},{key:"deleteGood",value:function(e){if("number"==typeof e&&this.goods.some(function(t){return t.id===e})){var t=this.goods.findIndex(function(t){return t.id===e});console.log(t),console.log(this.goods),this.goods.splice(t,1),this.basketStorage(e,"DELETE"),this.state.count--,this.reset(),this.renderGoods()}}},{key:"addEventListener",value:function(e){var t=this;e instanceof Node&&e.addEventListener("click",function(){t.deleteGood(+e.getAttribute("data-id")-1)})}},{key:"basketStorage",value:function(e,t){var n=this;if("number"==typeof e||"string"==typeof t){var o=null;fetch("/my-user",{credentials:"include"}).then(function(e){return e.json()}).then(function(r){o=r,console.log(o.auth),!1===o.auth?localStorage.setItem("cart",JSON.stringify(n.goods)):fetch("/cart/0",{method:t,body:JSON.stringify({cart:e+1}),headers:{"Content-Type":"application/json"}}).then(function(e){if(200===e.status)return e;throw new Error(e.statusText)}).then(function(e){return e.json()}).then(function(e){return console.log(e)}).catch(function(e){return console.log(e)})}).catch(function(e){return console.log(e)})}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0);var i=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.title=n,this.price=o}return o(e,[{key:"render",value:function(e){var t=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),r=document.createElement("h4"),i=document.createElement("div"),a=document.createElement("p"),d=document.createElement("div"),c=document.createElement("button");t.classList.add("col-4"),n.classList.add("card"),o.classList.add("card-header"),r.classList.add("title"),i.classList.add("card-body"),d.classList.add("button-group"),c.classList.add("btn"),c.classList.add("btn-primary"),t.id=""+(this.id+1),r.textContent=this.id+1+". "+this.title,a.textContent="Price: "+this.price+"$",c.textContent="Add to cart",d.appendChild(c),a.appendChild(d),i.appendChild(a),n.appendChild(o),o.appendChild(r),n.appendChild(i),t.appendChild(n),e.appendChild(t),this.addEventListener(c)}},{key:"addEventListener",value:function(e){var t=this;e.addEventListener("click",function(){r.basket.addGood({id:t.id,title:t.title,price:t.price})})}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(2));var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.render()}return o(e,[{key:"getGoodList",value:function(e,t){"string"==typeof e&&t instanceof Node&&this.getApi(e).then(function(e){console.log(e),e.map(function(e){return new r.default(e.id,e.productName,e.price)}).forEach(function(e){return e.render(t)})}).catch(function(e){return t.textContent=e})}},{key:"getApi",value:function(e){return fetch(e).then(function(e){if(200===e.status)return e;throw new Error("Ошибка")}).then(function(e){return e.json()}).catch(function(e){return Promise.reject(e)})}},{key:"render",value:function(){var e=document.querySelector(".goods");this.getGoodList("./goods",e)}}]),e}();t.default=i},function(e,t){}]);